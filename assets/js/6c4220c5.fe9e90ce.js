"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[8751],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=r.createContext({}),u=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(i.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(n),d=o,g=c["".concat(i,".").concat(d)]||c[d]||m[d]||a;return n?r.createElement(g,s(s({ref:t},p),{},{components:n})):r.createElement(g,s({ref:t},p))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=d;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l[c]="string"==typeof e?e:o,s[1]=l;for(var u=2;u<a;u++)s[u]=n[u];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5177:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>m,frontMatter:()=>a,metadata:()=>l,toc:()=>u});var r=n(7462),o=(n(7294),n(3905));const a={title:"Routes et Base Controller"},s=void 0,l={unversionedId:"laravel/Installation/StepByStep/route-controller",id:"laravel/Installation/StepByStep/route-controller",title:"Routes et Base Controller",description:"Ajouter le namespace pour charger automatiquement les controllers",source:"@site/docs/laravel/Installation/StepByStep/route-controller.md",sourceDirName:"laravel/Installation/StepByStep",slug:"/laravel/Installation/StepByStep/route-controller",permalink:"/documentation/docs/laravel/Installation/StepByStep/route-controller",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/laravel/Installation/StepByStep/route-controller.md",tags:[],version:"current",frontMatter:{title:"Routes et Base Controller"},sidebar:"laravelSidebar",previous:{title:"Laravel Nova",permalink:"/documentation/docs/laravel/Installation/StepByStep/laravel-nova"},next:{title:"Pr\xe9parer web.php",permalink:"/documentation/docs/laravel/Features/web-php"}},i={},u=[{value:"Ajouter le namespace pour charger automatiquement les controllers",id:"ajouter-le-namespace-pour-charger-automatiquement-les-controllers",level:2},{value:"Configurer BaseController et IndexController",id:"configurer-basecontroller-et-indexcontroller",level:2},{value:"Configurer les routes",id:"configurer-les-routes",level:2}],p={toc:u},c="wrapper";function m(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"ajouter-le-namespace-pour-charger-automatiquement-les-controllers"},"Ajouter le namespace pour charger automatiquement les controllers"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="/app/Services/RouteServicesProvider.php"',title:'"/app/Services/RouteServicesProvider.php"'},"...\nclass RouteServiceProvider extends ServiceProvider {...\n    public function boot(): void {\n\n        $this->routes(function () {\n            Route::middleware('web')\n                // highlight-start\n                ->namespace('App\\Http\\Controllers')\n                // highlight-end\n                ->group(base_path('routes/web.php'));\n        });\n    }\n}\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Ajouter ",(0,o.kt)("inlineCode",{parentName:"p"},"->namespace('App\\Http\\Controllers')")," est n\xe9cessaire pour que syntaxe courte ",(0,o.kt)("inlineCode",{parentName:"p"},"IndexController@home")," des routes fonctionne.")),(0,o.kt)("h2",{id:"configurer-basecontroller-et-indexcontroller"},"Configurer BaseController et IndexController"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="/app/Http/Controllers/BaseController.php"',title:'"/app/Http/Controllers/BaseController.php"'},"<?php\n\nnamespace App\\Http\\Controllers;\n\n//use App\\Services\\MetasService;\nuse Illuminate\\Foundation\\Auth\\Access\\AuthorizesRequests;\nuse Illuminate\\Foundation\\Validation\\ValidatesRequests;\nuse Illuminate\\Routing\\Controller as LaravelController;\nuse Illuminate\\Support\\Facades\\View;\n\nclass BaseController extends LaravelController {\n    use AuthorizesRequests, ValidatesRequests;\n\n    public function __construct() {\n        // Chargement des variables globales utilisables dans toutes les vues, et overridables dans les controllers\n        //View::share('title', MetasService::getTitle());\n        //View::share('description', MetasService::getDescription());\n    }\n}\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Penser \xe0 cr\xe9er les vues correspondantes \xe0 chaque action, dans ",(0,o.kt)("inlineCode",{parentName:"p"},"/ressources/views/mapage.blade.php")," par exemple, ou dans un sous-dossier avec la syntaxe ",(0,o.kt)("inlineCode",{parentName:"p"},"return view('pages-editos.mapage')")," pour la vue situ\xe9e dans ",(0,o.kt)("inlineCode",{parentName:"p"},"/ressources/views/pages-editos/mapage.blade.php"),";")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="/app/Http/Controllers/IndexController.php"',title:'"/app/Http/Controllers/IndexController.php"'},"<?php\n\nnamespace App\\Http\\Controllers;\n\nuse Illuminate\\Foundation\\Auth\\Access\\AuthorizesRequests;\nuse Illuminate\\Foundation\\Validation\\ValidatesRequests;\nuse Illuminate\\Http\\Request;\n//use App\\Models\\ContactMessage;\nuse JoliMardi\\Flash\\Flash;\n\nclass IndexController extends BaseController {\n    use AuthorizesRequests, ValidatesRequests;\n\n    public function home() {\n        //Flash::message('success', 'Une erreur s\\'est produite lors de l\\'envoi de votre message. Veuillez r\xe9essayer plus tard.');\n        return view('home');\n    }\n    \n    public function soins() {\n        return view('soins');\n    }\n\n    public function contact() {\n        return view('contact');\n    }\n\n    /* Pour plus tard \n    public function send(Request $request) {\n        // Validation\n        $request->validate([\n            'name' => 'required|min:3|max:255',\n            'email' => 'required|email',\n            'message' => 'required|min:5'\n        ]);\n\n        $params = [\n            'name' => $request->name,\n            'email' => $request->email,\n            'message' => $request->message\n        ];\n\n        $contactMessage = new ContactMessage;\n        $contactMessage->name = $request->name;\n        $contactMessage->email = $request->email;\n        $contactMessage->message = $request->message;\n\n        if ($contactMessage->save()) {\n            // Redirection avec flash message\n\n            $sendinBlueService = app(SendinBlueService::class);\n\n            if ($sendinBlueService->sendEmail($request->email, $request->name, $params, 3)) {\n                Flash::message('success', 'Merci pour votre message ! Nous vous r\xe9pondrons dans les plus brefs d\xe9lais.');\n                return back()->withInput();\n            } else {\n                return back()->withInput();\n            }\n        } else {\n            Flash::message('error', 'Une erreur s\\'est produite lors de l\\'envoi de votre message. Veuillez r\xe9essayer plus tard.');\n            return back()->withInput();\n        }\n    }\n    */\n}\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Si erreur ",(0,o.kt)("strong",{parentName:"p"},"Target class ","[IndexController]"," does not exist."),", il faut ajouter ",(0,o.kt)("inlineCode",{parentName:"p"},"->namespace...")," dans RouteServiceProvider.php (voir au-dessus)")),(0,o.kt)("h2",{id:"configurer-les-routes"},"Configurer les routes"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="routes/web.php"',title:'"routes/web.php"'},"<?php\n\nnamespace App\\Http\\Controllers;\n\nuse Illuminate\\Support\\Facades\\Route;\n\n/* ----------    Index Controller   ---------------------- */\n\nRoute::get('/', 'IndexController@home')->name('home');\n\nRoute::get('/contact', 'IndexController@contact')->name('contact');\nRoute::post('/contact', 'IndexController@send')->name('contact.send'); // Mettre des points permet de filtrer des r\xe8gle splus tard sur admin.* par exemple\n\n// Exemple \xe9ditable\nRoute::get('mon-slug', 'MonController@mon_action')->name('mon_nom_de route'); // dans la vue : `href=\"{{ route('mon_nom_de_route')}}\"`\n")),(0,o.kt)("hr",null),(0,o.kt)("p",null,"Exemple plus complet, \xe0 adapter selon le projet :"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="routes/web.php"',title:'"routes/web.php"'},"<?php\n\nnamespace App\\Http\\Controllers;\nuse Illuminate\\Support\\Facades\\Route;\n\n/* ----------    Index Controller   ---------------------- */\nRoute::get('/', 'IndexController@home')->name('home');\nRoute::get('/contact', 'IndexController@contact')->name('contact');\nRoute::post('/contact', 'IndexController@send')->name('contact.send');\n\nRoute::get('comment-ca-marche', 'IndexController@comment_ca_marche')->name('comment-ca-marche');\nRoute::get('team', 'IndexController@team')->name('team');\nRoute::get('mentions-legales', 'IndexController@mentions_legales')->name('mentions-legales');\n\n\n/* ----------    Artistes avec un group de routes   ---------------------- */\nRoute::controller(ArtistController::class) // Nom du controlleur\n    ->group(function () {\n        Route::get('artistes', 'list')->name('artists.list');\n        Route::get('artistes/{slug}', 'view')->name('artists.view');\n        Route::get('artistes-{category}', 'category')->name('artists.category');\n    });\n\n\n/* ----------    Admin avec middleware Auth (Doc @TODO)   ---------------------- */\n$admin_prefix = env('ADMIN_SLUG', 'admin');\nRoute::middleware(['auth'])\n    ->prefix($admin_prefix)\n    ->controller(AdminController::class)\n    ->group(function () {\n        Route::get('/', 'dashboard')->name('admin.dashboard');\n        Route::post('/', 'dashboard')->name('admin.filterArtists');\n        Route::get('/logout', 'logout')->name('admin.logout');\n    });\nRoute::get($admin_prefix . '/login', 'AdminController@login')->name('admin.login');\nRoute::post($admin_prefix . '/check-login', 'AdminController@checkLogin')->name('admin.check-login');\n\n\n/* ----------    Articles   ---------------------- */\nRoute::controller(ArticlesController::class)\n    ->group(function () {\n        // Global\n        Route::get('articles', 'articles')->name('articles');\n        // Post\n        Route::get('conseils', 'list_posts')->name('posts.list');\n        Route::get('conseils/{slug}', 'view_post')->name('posts.view');\n        // Realisation\n        Route::get('realisations', 'list_realisations')->name('realisations.list');\n        Route::get('realisations/{slug}', 'view_realisation')->name('realisations.view');\n    });\n\n")))}m.isMDXComponent=!0}}]);