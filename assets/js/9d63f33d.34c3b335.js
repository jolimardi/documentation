"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[4969],{3286(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"laravel/Installation/StepByStep/vite-app","title":"Vite.js & app.js","description":"Vite.js est le builder js utilis\xe9 par Laravel. Cela permet d\'ajouter des plugins au projet via npm, de compiler les assets (js, scss, images...) et de live-reload les pages pendant le dev.","source":"@site/docs/laravel/Installation/StepByStep/03-vite-app.md","sourceDirName":"laravel/Installation/StepByStep","slug":"/laravel/Installation/StepByStep/vite-app","permalink":"/documentation/docs/laravel/Installation/StepByStep/vite-app","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/laravel/Installation/StepByStep/03-vite-app.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Vite.js & app.js"},"sidebar":"laravelSidebar","previous":{"title":"Packages Composer","permalink":"/documentation/docs/laravel/Installation/StepByStep/packages-composer"},"next":{"title":"Layout Principal","permalink":"/documentation/docs/laravel/Installation/StepByStep/layout-principal"}}');var t=r(4848),i=r(8453);const o={title:"Vite.js & app.js"},a=void 0,l={},c=[{value:"Compilation CSS avec Vite.js",id:"compilation-css-avec-vitejs",level:2},{value:"Chargement des assets dans le HTML avec Vite.js",id:"chargement-des-assets-dans-le-html-avec-vitejs",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["Vite.js est le builder js utilis\xe9 par Laravel. Cela permet d'ajouter des plugins au projet via ",(0,t.jsx)(n.code,{children:"npm"}),", de compiler les assets (js, scss, images...) et de live-reload les pages pendant le dev."]}),"\n",(0,t.jsx)(n.h2,{id:"compilation-css-avec-vitejs",children:"Compilation CSS avec Vite.js"}),"\n",(0,t.jsx)(n.p,{children:"Installation de quelques plugins pour PostCSS, PostCSS-Nesting et Autoprefixer"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm install postcss --save-dev\r\nnpm install postcss-nesting --save-dev\r\nnpm install autoprefixer --save-dev\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Pourquoi PostCSS Nesting ?",type:"tip",children:(0,t.jsxs)(n.p,{children:["Permet d'\xe9crire du CSS avec syntaxe imbriqu\xe9e (comme Sass) directement dans les fichiers ",(0,t.jsx)(n.code,{children:".css"}),". Autoprefixer ajoute automatiquement les pr\xe9fixes navigateurs (",(0,t.jsx)(n.code,{children:"-webkit-"}),", ",(0,t.jsx)(n.code,{children:"-moz-"}),", etc.)."]})}),"\n",(0,t.jsxs)(n.p,{children:["Puis configuration \xe0 la racine du projet, dans ",(0,t.jsx)(n.code,{children:"vite.config.js"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="/vite.config.js"',children:"import { defineConfig } from 'vite';\r\nimport laravel from 'laravel-vite-plugin';\r\n\r\n// CSS\r\nimport postcssNesting from 'postcss-nesting';\r\nimport autoprefixer from 'autoprefixer';\r\n\r\nexport default defineConfig({\r\n    plugins: [\r\n        laravel({\r\n            input: ['resources/css/app.css', 'resources/js/app.js'], // Ajouter ici les resources \xe0 compiler\r\n            refresh: true,\r\n        }),\r\n    ],\r\n    css: {\r\n        postcss: {\r\n            plugins: [\r\n                postcssNesting,\r\n                autoprefixer\r\n            ],\r\n            map: { inline: true }\r\n        },\r\n    },\r\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"chargement-des-assets-dans-le-html-avec-vitejs",children:"Chargement des assets dans le HTML avec Vite.js"}),"\n",(0,t.jsxs)(n.p,{children:["Il faut ensuite charger ces fichiers compil\xe9s dans le Layout blade principal ",(0,t.jsx)(n.code,{children:"/resources/views/layout.blade.php"})," grace \xe0 la directive sp\xe9ciale ",(0,t.jsx)(n.code,{children:"@vite"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Par exemple, pour les deux fichiers pr\xe9sents dans le ",(0,t.jsx)(n.code,{children:"input"})," de ",(0,t.jsx)(n.code,{children:"vite.config.js"})," ci-dessus, on peut les charger dans le ",(0,t.jsx)(n.code,{children:"<head>"})," avec ",(0,t.jsx)(n.code,{children:"@vite('resources/css/app.css')"})," et ",(0,t.jsx)(n.code,{children:"@vite('resources/css/app.js')"}),"."]}),"\n",(0,t.jsx)(n.admonition,{title:"Dev vs Production",type:"info",children:(0,t.jsxs)(n.p,{children:[(0,t.jsxs)(n.strong,{children:["En dev (",(0,t.jsx)(n.code,{children:"npm run dev"}),")"]})," : ",(0,t.jsx)(n.code,{children:"@vite"})," charge les assets via le serveur Vite avec hot reload.\r\n",(0,t.jsxs)(n.strong,{children:["En prod (",(0,t.jsx)(n.code,{children:"npm run build"}),")"]})," : ",(0,t.jsx)(n.code,{children:"@vite"})," charge les assets compil\xe9s depuis ",(0,t.jsx)(n.code,{children:"public/build/"})," avec hash dans le nom pour cache-busting."]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",metastring:'title="/resources/views/layout.blade.php"',children:"<head>\r\n    <meta charset=\"utf-8\">\r\n    <title>{{ $title ?? env('APP_NAME') }}</title>\r\n    <meta name=\"description\" content=\"{{ $description }}\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n    \r\n    ...\r\n\r\n    {{-- Chargement du CSS --}}\r\n    // highlight-start\r\n    @vite('resources/css/app.css')\r\n    // highlight-end\r\n\r\n    @stack('styles')\r\n\r\n    @stack('js_vars')\r\n</head>\r\n<body>\r\n\r\n    ...\r\n\r\n    {{-- Chargement des js --}}\r\n    // highlight-start\r\n    @vite('resources/js/app.js')\r\n    // highlight-end\r\n</body>\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["Pour ajouter de nouveaux fichiers CSS au projet projet, vous pouvez soit les ajouter dans ",(0,t.jsx)(n.code,{children:"vite.config.js"}),", soit dans le fichier CSS de base (",(0,t.jsx)(n.code,{children:"resources/css/app.css"})," par exemple) avec un ",(0,t.jsx)(n.code,{children:'@import "../../node_modules/@fancyapps/ui/dist/fancybox/fancybox.css";'})," par exemple."]})}),"\n",(0,t.jsx)(n.h1,{id:"js-commun-\xe0-tous-les-sites-jolimardi",children:"JS commun \xe0 tous les sites JoliMardi"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="/resources/js/app.js"',children:"import './bootstrap';\r\n\r\n/* ---------------    ci-dessous : JS commun \xe0 tous les sites, \xe0 d\xe9placer   ---------------------- */\r\n\r\n$(function () {\r\n\r\n    //--------- Menu mobile ------------*/\r\n    $('.menu-bars, .menu-close, .home-menu-bars, .mobile-menu .menu a, .menu-overlay').click(function (e) {\r\n        e.stopPropagation();\r\n        $('body').toggleClass('mobile-menu-opened');\r\n    });\r\n\r\n\r\n    // Click on card [data-href]\r\n    $('[data-href]').on('click', function (e) {\r\n        if (!$(e.target).is('a, a *, .dropdown, .dropdown *')) {\r\n            e.preventDefault();\r\n            window.location = $(this).data('href');\r\n        }\r\n    });\r\n\r\n\r\n    /* ---------     Custom Scroll To (add data-anchor=#id)   ------------------------ */\r\n    $('[data-anchor]').on('click', function (e) {\r\n        var anchor = $(this).data('anchor');\r\n        if (anchor.charAt(0) != '#') {\r\n            anchor = '#' + anchor;\r\n        }\r\n        if ($(anchor).length > 0) {\r\n            myScrollTo(anchor); // D\xe9finie en bas du fichier\r\n        }\r\n    });\r\n    /* ----------------------------    Scroll To si hash    ------------------------ */\r\n    if (window.location.hash) {\r\n        var anchor = window.location.hash;\r\n        myScrollTo(anchor);\r\n        scrollAction();\r\n    }\r\n\r\n    /* --------- Scroll ------------- */\r\n    function scrollAction() {\r\n        var scrollPos = $(window).scrollTop();\r\n        if (scrollPos > 200) {\r\n            $('body').addClass('topbar-small');\r\n        } else {\r\n            $('body').removeClass('topbar-small');\r\n        }\r\n    }\r\n    $(window).on('scroll', throttle(scrollAction, 40));\r\n    $(window).on('load', scrollAction);\r\n});\r\n\r\n\r\nfunction myScrollTo(anchor) {\r\n    var $elem;\r\n    if (anchor instanceof jQuery) {\r\n        $elem = anchor;\r\n    } else {\r\n        var id = anchor;\r\n        $elem = $(id);\r\n    }\r\n    if ($elem.length == 0) {\r\n        return;\r\n    }\r\n    $(\"html, body\").animate({ scrollTop: $elem.offset().top - 75 }, 200);\r\n}\r\n\r\n\r\n \r\n\r\n// Avoid `console` errors in browsers that lack a console.\r\n(function () {\r\n    var method;\r\n    var noop = function () {};\r\n    var methods = [\r\n        'assert', 'clear', 'count', 'debug', 'dir', 'dirxml', 'error',\r\n        'exception', 'group', 'groupCollapsed', 'groupEnd', 'info', 'log',\r\n        'markTimeline', 'profile', 'profileEnd', 'table', 'time', 'timeEnd',\r\n        'timeline', 'timelineEnd', 'timeStamp', 'trace', 'warn'\r\n    ];\r\n    var length = methods.length;\r\n    var console = (window.console = window.console || {});\r\n\r\n    while (length--) {\r\n        method = methods[length];\r\n\r\n        // Only stub undefined methods.\r\n        if (!console[method]) {\r\n            console[method] = noop;\r\n        }\r\n    }\r\n}());\r\n\r\n\r\nfunction throttle(fn, threshhold, scope) {\r\n    threshhold || (threshhold = 250);\r\n    var last,\r\n            deferTimer;\r\n    return function () {\r\n        var context = scope || this;\r\n        var now = +new Date,\r\n                args = arguments;\r\n        if (last && now < last + threshhold) {\r\n            // hold on to it\r\n            clearTimeout(deferTimer);\r\n            deferTimer = setTimeout(function () {\r\n                last = now;\r\n                fn.apply(context, args);\r\n            }, threshhold);\r\n        } else {\r\n            last = now;\r\n            fn.apply(context, args);\r\n        }\r\n    };\r\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:'Erreur : "Vite manifest not found"'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Solution : Lancer ",(0,t.jsx)(n.code,{children:"npm run build"})," pour g\xe9n\xe9rer les assets de production, ou ",(0,t.jsx)(n.code,{children:"npm run dev"})," en environnement local."]}),"\n",(0,t.jsxs)(n.li,{children:["En production, v\xe9rifier que ",(0,t.jsx)(n.code,{children:"public/build/manifest.json"})," existe apr\xe8s le build."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Hot reload ne fonctionne pas"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["V\xe9rifier que ",(0,t.jsx)(n.code,{children:"npm run dev"})," est bien lanc\xe9"]}),"\n",(0,t.jsxs)(n.li,{children:["V\xe9rifier le port Vite dans ",(0,t.jsx)(n.code,{children:"vite.config.js"})," (par d\xe9faut 5173)"]}),"\n",(0,t.jsxs)(n.li,{children:["Si derri\xe8re un proxy : configurer ",(0,t.jsx)(n.code,{children:"server.hmr"})," dans vite.config.js"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{title:"Documentation Vite",type:"tip",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://vitejs.dev/guide/",children:"https://vitejs.dev/guide/"})," - Guide complet Vite.js\r\n",(0,t.jsx)(n.a,{href:"https://laravel.com/docs/vite",children:"https://laravel.com/docs/vite"})," - Documentation Laravel Vite"]})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\xc9tape suivante :"})," ",(0,t.jsx)(n.a,{href:"./layout-principal",children:"4. Layout Principal"})]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>o,x:()=>a});var s=r(6540);const t={},i=s.createContext(t);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);